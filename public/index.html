TODO: korrekte weiterleitung zu career-finder.html (window.reload funktioniert nicht)
<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - KarriereFinder</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

    <div class="container">
        <div class="header-with-logo">
            <img src="images/Logo_komplett_transparent.png" alt="Firmenlogo" class="header-logo">
            <h1>Zugang zum KarriereFinder</h1>
        </div>

        <div class="form-section login-form">
            <h2>Passwort erforderlich</h2>
            <div id="loginMessage" class="message"></div>
            <form id="passwordForm">
                <label for="password">Passwort:</label>
                <input type="password" id="password" required>

                <div class="captcha-container">
                    <label for="captcha">Geben Sie den Text ein:</label>
                    <div class="captcha-image">
                        <span id="captchaText"></span>
                    </div>
                    <input type="text" id="captcha" placeholder="Captchacode eingeben" required>
                </div>

                <button type="submit">Zugang gewähren</button>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const passwordForm = document.getElementById('passwordForm');
            const passwordInput = document.getElementById('password');
            const captchaInput = document.getElementById('captcha');
            const captchaTextSpan = document.getElementById('captchaText');
            const loginMessage = document.getElementById('loginMessage');

            let captchaValue = '';

            const generateCaptcha = () => {
                const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
                let result = '';
                for (let i = 0; i < 6; i++) {
                    result += characters.charAt(Math.floor(Math.random() * characters.length));
                }
                return result;
            };

            const loadCaptcha = () => {
                captchaValue = generateCaptcha();
                captchaTextSpan.textContent = captchaValue;
            };

            loadCaptcha();

            passwordForm.addEventListener('submit', async (event) => {
                event.preventDefault();

                const enteredPassword = passwordInput.value;
                const enteredCaptcha = captchaInput.value;

                if (enteredCaptcha !== captchaValue) {
                    loginMessage.textContent = 'Das Captcha ist falsch.';
                    loginMessage.style.color = 'red';
                    captchaInput.value = '';
                    loadCaptcha();
                    return;
                }

                try {
                    const response = await fetch('/api/login', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ password: enteredPassword })
                    });

                    const data = await response.json();

                    if (response.ok) {
                        // NEU: Anstatt direkt weiterzuleiten, die Seite neu laden.
                        // Der Server wird jetzt die Weiterleitung übernehmen.
                        window.location.href = 'career-finder.html';
                    } else {
                        loginMessage.textContent = data.message || 'Anmeldung fehlgeschlagen.';
                        loginMessage.style.color = 'red';
                        passwordInput.value = '';
                        captchaInput.value = '';
                        loadCaptcha();
                    }
                } catch (error) {
                    console.error('Fehler bei der Verbindung zum Server:', error);
                    loginMessage.textContent = 'Verbindungsfehler. Server nicht erreichbar.';
                    loginMessage.style.color = 'red';
                }
            });
        });
    </script>

</body>

</html>